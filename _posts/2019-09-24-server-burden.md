---
layout: post
title: サーバー負荷の解放
tags:
  - 障害情報
  - お知らせ
authors:
  - Takym
---
昨日の深夜(23時半頃)にまた描画バグが発生しました。<br />
場所はリスポーン地点周辺の共有倉庫前でした。<br />
<img src="https://takym.github.io/nyuworld/articles/2019-09-24-graphics-bug.png" width="600" /><br />
描画バグは何時何処で発生するか分からず、原因は不明ですが、サーバーの負荷が一番可能性が高そうです。<br />
そもそも、描画バグはサーバーからブロック情報を読み出す事に失敗して、<br />
実際に存在しているブロックが見えなくなる不具合です。<br />
描画バグが発生した空間に飛び込むと、奈落に落ちたり時間がおかしくなったりします。<br />
サーバー側が原因で情報を読み出せなくなるので、サーバーの負荷が原因と考えています。<br />
大人数で遊んで居るサーバーですので、処理落ちの原因は増え易いです。<br />
皆で協力して減らさないと直ぐに重くなってしまい、予期せぬ不具合が発生します。

## サーバー負荷の主な原因と解決方法
 * 大量のモブ/エンティティ
	* モブはそれぞれ動作を持っているので、多数存在していると処理落ちの原因になります。
	* 家畜やペット等はできる限り減らしましょう。
 * 大量の看板
	* 看板には文字列データが保存されており、通常のブロックより読み込み時間が少し長くなります。
	* 看板は重要な物以外は取り壊しましょう。
 * 永久稼働型のクロック回路
	* クロック回路は常に作動し続ける為、レッドストーンの更新により処理落ちします。
	* クロック回路には停止機能を付けましょう。
 * トラップ
	* トラップは敵モブを大量に湧かせて倒すという機構の為、処理落ちの原因になります。
	* トラップには停止機能を付けましょう。
 * 光源の点滅
	* 光源を点滅させると周囲のブロック情報の更新が必要になります。
	* 更に、クロック回路も利用しているので、処理落ちの原因になります。
	* 光源を点滅させる回路は無くしましょう。
 * かまど、醸造台等の稼働
	* かまどや醸造台等の何らかの動作を実行し続けるブロックも、処理落ちの原因になります。
	* 長時間のかまど、醸造台等の利用は止めましょう。
 * 地下施設の村人移動
	* 実はにゅうワールドのリスポーン地点の地下には謎の施設があり、
	* そこには大量の家畜・村人が存在し、常時稼働型のダブルスポナートラップもあります。
	* 更に地上の村に共鳴して村人が暴走して処理落ちさせます。
	* 管理人に相談して減らして貰うしかありません。

## 解決の方針
ここからはこのサーバーでの暫定的な解決の方針です。<br />
まだ本決まりではないので安心してください。

### 区分けする
以下の様に用途に合わせた場所を作る事で負荷を分散する方針です。
また、以下の地区は複数設置する事もあります。
 * **観光区**
	* ペット・家畜等は一切配置しません。
	* また、施設やトラップも少な目にします。
	* 主に建築物を観光するのが目的の地区です。
	* リスポーン地点周辺は観光区にする予定です。
	* 基本的に、看板は重要な物のみ、赤石回路は極力減らす、トラップの常時稼働の禁止、になります。
	* この地区では例え所有者であっても「立ち入り禁止」を宣言する事はできません。
 * **居住区**
	* 人(プレイヤー)が生活する為の地区です。
	* ペット・家畜等は極力減らします。
	* 施設やトラップも観光区同様、少な目です。
	* この地区は新たに作る予定です。
	* リスポーン地点を観光区にして居住区を新たに作るのは、建築物を増やすという目的もあります。
	* この地区では所有者は「立ち入り禁止」を宣言できます。
 * **農業区**
	* 主に農業を行う地区です。
	* 畑はサーバー負荷の原因になりませんが、場所を整理する目的で設けます。
	* 巨大壁画畑や南瓜畑の様な場所が農業区になります。
	* この地区では所有者は「立ち入り禁止」を宣言できます。
 * **家畜区**
	* 主に家畜を飼育する場所です。
	* ただし、極力数は減らします。
	* この地区は新たに設置し、リスポーン地点に散らばっている家畜をここに集めて管理する予定です。
	* リスポーン地点から遠い場所に設置されます。
	* 複数設置する事により負荷を分散します。
	* この地区では例え所有者であっても「立ち入り禁止」を宣言する事はできません。
 * **村人区**
	* 村人区は村人(NPC)が生活する場所で養育区と取引区の二つに分かれます。
	* **養育区**
		* 村人を増やす為の地区です。
		* 増やし過ぎない様に注意してください。
	* **取引区**
		* 村人と取引する為の地区です。
		* 養育区で誕生した逸材をここに住まわせます。
	* 魂真村は養育区であり、取引区でもあります。
	* リスポーン地点から遠い場所に設置されます。
	* 複数設置する事により負荷を分散します。
	* この地区では例え所有者であっても「立ち入り禁止」を宣言する事はできません。

### 新しい法律を設ける
以下の様な新しいルールを制定して、サーバー負荷になる事を禁止します。
```
永久稼働する物(クロック回路、トラップ、光源の点滅、等)の設置を禁ずる。
常時稼働する物には停止機能を付ける事を義務付ける。
10体以上のモブ/エンティティの所有を禁ずる。
重要な物(重要掲示板、お知らせ、表札、駅名、等)以外の看板の設置を禁ずる。
```

## 追伸
共有倉庫の資材が極めて減っています。<br />
特に鉱石が減っています。<br />
どなたかアイテムを入れて置いてください。
